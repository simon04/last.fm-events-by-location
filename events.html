<div class="navbar navbar-default">
  <div class="navbar-header">
    <span class="navbar-brand">
      <a href="http://last.fm/">
        <img src="http://cdn.last.fm/flatness/badges/lastfm_red_small.gif">
      </a>
    </span>
  </div>
  <div class="container">
    <form class="navbar-form form-search" ng-submit="path('/events/' + location + '/' + distance)">
      <input ng-model="location" type="text" class="form-control search-query" placeholder="Location" title="Location">
      <input ng-model="distance" type="text" class="form-control search-query" title="Distance (in kilometers)">
      <button type="submit" class="btn btn-default">Update Events</button>
      <input ng-model="filter" type="search" class="form-control search-query" placeholder="Filter" title="Filter" class="btn btn-default" list="filterList">
      <button class="btn btn-default" ng-class="{active: !!minical}" ng-click="minical = !minical">MiniCal</button>
      <button class="btn btn-default" ng-class="{active: !!minimap}" ng-click="minimap = !minimap">MiniMap</button>
    </form>
  </div>
</div>
<datalist id="filterList">
  <option ng-repeat="i in ::eventKeywords" ng-value="i"/>
</datalist>
<div class="container-fluid">
  <table class="table table-striped">
    <tr>
      <th>Date</th>
      <th>Venue</th>
      <th></th>
      <th>Event and Artists</th>
    </tr>
    <tr ng-repeat="e in filteredEvents" ng-class="{cancelled: e.cancelled == 1}">
      <td ng-hide="minical">
        <time ng-attr-datetime="::e.startDateFormatted" ng-bind="::e.startDateHumanized"></time>
      </td>
      <td ng-if="minical">
        <div mini-calendar ng-date="::e.startDate"></div>
      </td>
      <td>
        <img ng-if="minimap" ng-src="http://api.tiles.mapbox.com/v3/examples.map-vyofok3q/pin-s-star+c00({{e.venue.location['geo:point']['geo:long']}},{{e.venue.location['geo:point']['geo:lat']}})/{{e.venue.location['geo:point']['geo:long']}},{{e.venue.location['geo:point']['geo:lat']}},14/300x200.png" style="width:150px; height:100px;"></img>
        <a ng-show="e.website" ng-href="::e.website" ng-bind="::e.venue.name"></a>
        <span ng-show="!e.website" ng-bind="::e.venue.name"></span>
      </td>
      <td>
        <div class="crop">
          <img class="thumb" ng-src="{{::e.thumb}}">
        </div>
      </td>
      <td>
        <a ng-href="::e.url">
          <b ng-bind="::e.title"></b>
        </a>
        <ul>
          <li ng-repeat="artist in e.artistArray">
            <a ng-href="'http://www.last.fm/music/' + artist" ng-bind="::artist">
            </a>
          </li>
        </ul>
      </td>
    </tr>
  </table>
</div>
